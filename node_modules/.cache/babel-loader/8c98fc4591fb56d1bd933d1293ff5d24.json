{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/103421/Desktop/sample-app1_20220224/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/103421/Desktop/sample-app1_20220224/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\103421\\\\Desktop\\\\sample-app1_20220224\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React from'react';import{useState,useEffect}from'react';import{makeStyles,createStyles}from'@material-ui/core/styles';import{AppBar,Toolbar,TextField,Typography,Button,Select,MenuItem}from'@material-ui/core';import Backdrop from'@material-ui/core/Backdrop';import CircularProgress from'@material-ui/core/CircularProgress';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var useStyles=makeStyles(function(t){return createStyles({app:{},toolbar:{},title:{margin:\"1em 1em 1em 0\",flexGrow:1},content:{padding:\"3em 0em 3em 2em\",backgroundColor:\"#F6F6F6\"},execButton:{minWidth:\"6em\",minHeight:\"3em\"},bottomSpace1:{marginBottom:\"1em\"},backdrop:{zIndex:t.zIndex.drawer+1,color:'#fff'},attrAreaLine:{display:\"flex\",alignItems:\"center\"},commandArea:{padding:\"2em 3em 1em 3em\"},leftSpace1:{marginLeft:\"2em\"}});});function App(){var c=useStyles();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),userName=_useState2[0],setUserName=_useState2[1];var _useState3=useState(\"1\"),_useState4=_slicedToArray(_useState3,2),userAttributeName=_useState4[0],setUserAttributeName=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),userAttributeValue=_useState6[0],setUserAttributeValue=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isLoading=_useState8[0],setLoading=_useState8[1];var loading=function loading(execute,infinit){return/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);_context.prev=1;_context.next=4;return new Promise(function(r){return setTimeout(r,200);});case 4:_context.next=6;return execute();case 6:_context.prev=6;if(!infinit){setLoading(false);}return _context.finish(6);case 9:case\"end\":return _context.stop();}}},_callee,null,[[1,,6,9]]);}));};var onLogin=loading(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.post(\"/api/authstart\",{},{});case 3:res=_context2.sent;window.location.href=res.data.auth_url;_context2.next=9;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);case 9:case\"end\":return _context2.stop();}}},_callee2,null,[[0,7]]);})),true);var clearLocalData=function clearLocalData(){setUserName(null);};var onLogout=loading(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.post(\"/api/logout\",{},{});case 3:_context3.next=7;break;case 5:_context3.prev=5;_context3.t0=_context3[\"catch\"](0);case 7:clearLocalData();case 8:case\"end\":return _context3.stop();}}},_callee3,null,[[0,5]]);})));var apiErrorAction=function apiErrorAction(err){var _err$response;console.log(err);if(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===401){// 401 Unauthorized\nclearLocalData();}};var writeAttribute=function writeAttribute(attrName,value,settter){return loading(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var param,res,resultValue;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;param={attr:attrName,value:value};_context4.next=4;return axios.post(\"/api/setUserAttribute\",param,{});case 4:res=_context4.sent;resultValue=res.data.result;settter(resultValue);_context4.next=12;break;case 9:_context4.prev=9;_context4.t0=_context4[\"catch\"](0);apiErrorAction(_context4.t0);case 12:case\"end\":return _context4.stop();}}},_callee4,null,[[0,9]]);})));};var onWriteUserAttributeAt=loading(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return writeAttribute(userAttributeName||\"\",userAttributeValue,setUserAttributeValue)();case 3:_context5.next=8;break;case 5:_context5.prev=5;_context5.t0=_context5[\"catch\"](0);apiErrorAction(_context5.t0);case 8:case\"end\":return _context5.stop();}}},_callee5,null,[[0,5]]);})));var inRoom=loading(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return readAttribute(userAttributeName||\"\",setUserAttributeValue)();case 3:_context6.next=8;break;case 5:_context6.prev=5;_context6.t0=_context6[\"catch\"](0);apiErrorAction(_context6.t0);case 8:case\"end\":return _context6.stop();}}},_callee6,null,[[0,5]]);})));var outRoom=loading(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.prev=0;_context7.next=3;return readAttribute(userAttributeName||\"\",setUserAttributeValue)();case 3:_context7.next=8;break;case 5:_context7.prev=5;_context7.t0=_context7[\"catch\"](0);apiErrorAction(_context7.t0);case 8:case\"end\":return _context7.stop();}}},_callee7,null,[[0,5]]);})));var readAttribute=function readAttribute(attrName,settter){return loading(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){var param,res,value;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.prev=0;param={attr:attrName};_context8.next=4;return axios.post(\"/api/getUserAttribute\",param,{});case 4:res=_context8.sent;value=res.data.result;settter(value);_context8.next=12;break;case 9:_context8.prev=9;_context8.t0=_context8[\"catch\"](0);apiErrorAction(_context8.t0);case 12:case\"end\":return _context8.stop();}}},_callee8,null,[[0,9]]);})));};useEffect(function(){document.title=process.env.REACT_APP_APPLICATION_NAME_SHORT||\"\";loading(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(){var _res$data,res,_res$data2;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.prev=0;_context9.next=3;return axios.post(\"/api/status\",{},{});case 3:res=_context9.sent;if(((_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.login)===true){setUserName((_res$data2=res.data)===null||_res$data2===void 0?void 0:_res$data2.name);}_context9.next=10;break;case 7:_context9.prev=7;_context9.t0=_context9[\"catch\"](0);apiErrorAction(_context9.t0);case 10:case\"end\":return _context9.stop();}}},_callee9,null,[[0,7]]);})))();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:c.app,children:[/*#__PURE__*/_jsx(AppBar,{position:\"static\",children:/*#__PURE__*/_jsxs(Toolbar,{className:c.toolbar,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",className:c.title,children:process.env.REACT_APP_APPLICATION_NAME}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",className:[c.execButton,c.leftSpace1].join(\" \"),onClick:onLogout,children:\"\\u30ED\\u30B0\\u30A2\\u30A6\\u30C8\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:c.content,children:[/*#__PURE__*/_jsxs(\"div\",{className:[c.attrAreaLine,c.commandArea].join(\" \"),children:[/*#__PURE__*/_jsx(TextField,{id:\"user_name\",style:{width:\"7.6em\"},autoComplete:\"off\",InputLabelProps:{shrink:true},InputProps:{readOnly:true},value:userName||\"\"}),/*#__PURE__*/_jsx(\"label\",{children:\"\\u69D8\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",className:[c.execButton,c.leftSpace1].join(\" \"),onClick:onLogin,disabled:userName!==null,children:\"\\u30ED\\u30B0\\u30A4\\u30F3\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:[c.attrAreaLine,c.commandArea].join(\" \"),children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"32\",max:\"42\",step:\"0.1\",pattern:\"[3][2-9]\",style:{width:\"8em\"}}),/*#__PURE__*/_jsx(\"label\",{color:\"primary\",children:\"\\u2103\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",className:[c.execButton,c.leftSpace1].join(\" \"),onClick:onWriteUserAttributeAt,children:\"\\u4F53\\u6E29\\u8A18\\u9332\"})]}),/*#__PURE__*/_jsx(\"div\",{className:[c.attrAreaLine,c.commandArea].join(\" \"),children:/*#__PURE__*/_jsxs(Select,{style:{width:\"12em\"},variant:\"outlined\",value:userAttributeName,onChange:function onChange(e){return setUserAttributeName(String(e.target.value));},children:[/*#__PURE__*/_jsx(MenuItem,{value:\"1\",children:\"\\u5B9F\\u9A13\\u5BA41\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"2\",children:\"\\u5B9F\\u9A13\\u5BA42\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"3\",children:\"\\u5B9F\\u9A13\\u5BA43\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:[c.attrAreaLine,c.commandArea].join(\" \"),children:[/*#__PURE__*/_jsx(Button,{id:\"inr\",variant:\"contained\",color:\"primary\",className:[c.execButton,c.leftSpace1].join(\" \"),onClick:inRoom,children:\"\\u5165\\u5BA4\"}),/*#__PURE__*/_jsx(Button,{id:\"onr\",disabled:true,variant:\"contained\",color:\"primary\",className:[c.execButton,c.leftSpace1].join(\" \"),onClick:outRoom,children:\"\\u9000\\u5BA4\"})]})]})]}),/*#__PURE__*/_jsx(Backdrop,{className:c.backdrop,open:isLoading,children:/*#__PURE__*/_jsx(CircularProgress,{color:\"inherit\"})})]});}export default App;","map":{"version":3,"sources":["C:/Users/103421/Desktop/sample-app1_20220224/client/src/App.tsx"],"names":["React","useState","useEffect","makeStyles","createStyles","AppBar","Toolbar","TextField","Typography","Button","Select","MenuItem","Backdrop","CircularProgress","axios","useStyles","t","app","toolbar","title","margin","flexGrow","content","padding","backgroundColor","execButton","minWidth","minHeight","bottomSpace1","marginBottom","backdrop","zIndex","drawer","color","attrAreaLine","display","alignItems","commandArea","leftSpace1","marginLeft","App","c","userName","setUserName","userAttributeName","setUserAttributeName","userAttributeValue","setUserAttributeValue","isLoading","setLoading","loading","execute","infinit","Promise","r","setTimeout","onLogin","post","res","window","location","href","data","auth_url","clearLocalData","onLogout","apiErrorAction","err","console","log","response","status","writeAttribute","attrName","value","settter","param","attr","resultValue","result","onWriteUserAttributeAt","inRoom","readAttribute","outRoom","document","process","env","REACT_APP_APPLICATION_NAME_SHORT","login","name","REACT_APP_APPLICATION_NAME","join","width","shrink","readOnly","e","String","target"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useState, useEffect } from 'react';\nimport { makeStyles, createStyles, Theme } from '@material-ui/core/styles';\nimport { AppBar, Toolbar, TextField, Typography, Button, Select, MenuItem,} from '@material-ui/core';\nimport Backdrop from '@material-ui/core/Backdrop';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport axios from 'axios';\n\nconst useStyles = makeStyles((t: Theme) => createStyles({\n\tapp: { },\n\ttoolbar: { },\n\ttitle: { margin: \"1em 1em 1em 0\", flexGrow: 1 },\n\tcontent: { padding: \"3em 0em 3em 2em\", backgroundColor: \"#F6F6F6\" },\n\texecButton: { minWidth: \"6em\", minHeight: \"3em\" },\n\tbottomSpace1: { marginBottom: \"1em\" },\n\tbackdrop: { zIndex: t.zIndex.drawer + 1, color: '#fff' },\n\tattrAreaLine: { display: \"flex\", alignItems: \"center\" },\n\tcommandArea: {padding: \"2em 3em 1em 3em\" },\n\tleftSpace1: { marginLeft: \"2em\" },\n}));\n\nfunction App() {\n\tconst c = useStyles();\n\tconst [userName, setUserName] = useState<string | null>(null);\n\tconst [userAttributeName, setUserAttributeName] = useState<string>(\"1\");\n\tconst [userAttributeValue, setUserAttributeValue] = useState<string | null>(null);\n\tconst [isLoading, setLoading] = useState(false);\n\n\tconst loading = (execute: () => void, infinit?: boolean): (() => void) => {\n\t\treturn async () => {\n\t\t\tsetLoading(true);\n\t\t\ttry {\n\t\t\t\tawait new Promise(r => setTimeout(r, 200));\n\t\t\t\tawait execute();\n\t\t\t}\n\t\t\tfinally {\n\t\t\t\tif (!infinit) {\n\t\t\t\t\tsetLoading(false);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t};\n\n\tconst onLogin = loading(async () => {\n\t\ttry {\n\t\t\tconst res = await axios.post(\"/api/authstart\", {}, {});\n\t\t\twindow.location.href = res.data.auth_url;\n\t\t}\n\t\tcatch (err) {\n\t\t}\n\t}, true);\n\n\tconst clearLocalData = () => {\n\t\tsetUserName(null);\n\t};\n\n\tconst onLogout = loading(async () => {\n\t\ttry {\n\t\t\tawait axios.post(\"/api/logout\", {}, {});\n\t\t}\n\t\tcatch (err) {\n\t\t}\n\t\tclearLocalData();\n\t});\n\n\tconst apiErrorAction = (err: any) => {\n\t\tconsole.log(err);\n\t\tif (err.response?.status === 401) { // 401 Unauthorized\n\t\t\tclearLocalData();\n\t\t}\n\t}\n\n\tconst writeAttribute = (attrName: string, value: string | null, settter: (v: string) => void): (() => void) => { return loading(async () => {\n\t\ttry {\n\t\t\tconst param = { attr: attrName, value: value };\n\t\t\tconst res = await axios.post(\"/api/setUserAttribute\", param, {});\n\t\t\tconst resultValue = res.data.result;\n\t\t\tsettter(resultValue);\n\t\t}\n\t\tcatch (err) {\n\t\t\tapiErrorAction(err);\n\t\t}\n\t})};\n\n\tconst onWriteUserAttributeAt = loading(async () => {\n\t\ttry {\n\t\t\tawait writeAttribute(userAttributeName || \"\", userAttributeValue, setUserAttributeValue)();\n\t\t}\n\t\tcatch (err) {\n\t\t\tapiErrorAction(err);\n\t\t}\n\t});\n\n\tconst inRoom = loading(async () => {\n\n\t\ttry {\n\t\t\tawait readAttribute(userAttributeName || \"\", setUserAttributeValue)();\n\t\t}\n\t\tcatch (err) {\n\t\t\tapiErrorAction(err);\n\t\t}\n\t});\n\n\tconst outRoom = loading(async () => {\n\t\ttry {\n\t\t\tawait readAttribute(userAttributeName || \"\", setUserAttributeValue)();\n\t\t}\n\t\tcatch (err) {\n\t\t\tapiErrorAction(err);\n\t\t}\n\t});\n\n\tconst readAttribute = (attrName: string, settter: (v: string) => void): (() => void) => { return loading(async () => {\n\t\ttry {\n\t\t\tconst param = { attr: attrName };\n\t\t\tconst res = await axios.post(\"/api/getUserAttribute\", param, {});\n\t\t\tconst value = res.data.result\n\t\t\tsettter(value);\n\t\t}\n\t\tcatch (err) {\n\t\t\tapiErrorAction(err);\n\t\t}\n\t})};\n\n\tuseEffect(() => {\n\t\tdocument.title = process.env.REACT_APP_APPLICATION_NAME_SHORT || \"\";\n\t\tloading(async () => {\n\t\t\ttry {\n\t\t\t\tconst res = await axios.post(\"/api/status\", {}, {});\n\t\t\t\tif (res.data?.login === true) {\n\t\t\t\t\tsetUserName(res.data?.name);\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (err) {\n\t\t\t\tapiErrorAction(err);\n\t\t\t}\n\t\t})();\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, []);\n\n\treturn (\n\t\t<>\n\t\t\t<div className={c.app}>\n\t\t\t\t<AppBar position=\"static\">\n\t\t\t\t\t<Toolbar className={c.toolbar}>\n\t\t\t\t\t\t<Typography variant=\"h6\" className={c.title}>{process.env.REACT_APP_APPLICATION_NAME}</Typography>\n\t\t\t\t\t\t<Button variant=\"contained\" className={[c.execButton, c.leftSpace1].join(\" \")} onClick={onLogout}>ログアウト</Button>\n\t\t\t\t\t</Toolbar>\n\t\t\t\t</AppBar>\n\t\t\t\t<div className={c.content}>\n\t\t\t\t\t<div className={[c.attrAreaLine, c.commandArea].join(\" \")}>\n\t\t\t\t\t\t<TextField id=\"user_name\" style={{width: \"7.6em\"}} autoComplete=\"off\" InputLabelProps={{shrink: true}} InputProps={{readOnly: true}}  value={userName || \"\"}/>\n\t\t\t\t\t\t<label>様</label>\n\t\t\t\t\t\t<Button variant=\"contained\" color=\"primary\" className={[c.execButton, c.leftSpace1].join(\" \")} onClick={onLogin} disabled={userName !== null}>ログイン</Button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={[c.attrAreaLine, c.commandArea].join(\" \")}>\n\t\t\t\t\t\t<input type='number' min='32' max='42' step='0.1' pattern='[3][2-9]' style={{width: \"8em\"}}/>\n\t\t\t\t\t\t<label color=\"primary\">℃</label>\n\t\t\t\t\t\t<Button variant=\"contained\" color=\"primary\" className={[c.execButton, c.leftSpace1].join(\" \")} onClick={onWriteUserAttributeAt}>体温記録</Button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={[c.attrAreaLine, c.commandArea].join(\" \")}>\n\t\t\t\t\t\t<Select style={{width: \"12em\"}} variant=\"outlined\" value={userAttributeName} onChange={e => setUserAttributeName(String(e.target.value))}>\n\t\t\t\t\t\t\t<MenuItem value=\"1\">実験室1</MenuItem>\n\t\t\t\t\t\t\t<MenuItem value=\"2\">実験室2</MenuItem>\n\t\t\t\t\t\t\t<MenuItem value=\"3\">実験室3</MenuItem>\n\t\t\t\t\t\t</Select>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={[c.attrAreaLine, c.commandArea].join(\" \")}>\n\t\t\t\t\t<Button id=\"inr\" variant=\"contained\" color=\"primary\" className={[c.execButton, c.leftSpace1].join(\" \")} onClick={inRoom}>入室</Button>\n\t\t\t\t\t<Button id=\"onr\" disabled variant=\"contained\" color=\"primary\" className={[c.execButton, c.leftSpace1].join(\" \")} onClick={outRoom}>退室</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<Backdrop className={c.backdrop} open={isLoading}>\n\t\t\t\t<CircularProgress color=\"inherit\" />\n\t\t\t</Backdrop>\n\t\t</>\n\t);\n}\nexport default App;"]},"metadata":{},"sourceType":"module"}